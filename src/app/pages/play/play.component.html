<div class="field">

  <div class="opponent-side" [class.current-turn]="gamestate.currentTurn === 1">
    <div class="stats">
      <div class="health opponent-health">
        <ngb-progressbar type="health" [value]="opponent.health" [max]="opponent.maxHealth" [animated]="true"
          height="24px" />
      </div>

      <div class="mana opponent-mana">
        @for(mana of manaArray(opponent.maxMana); track mana) {
        <div class="mana-orb" [class.active]="opponent.mana > mana"></div>
        }
      </div>
    </div>

    <div class="visuals">
      <div class="opponent">
        <sw-character-sprite [sprite]="opponent.sprite"></sw-character-sprite>
      </div>
    </div>
  </div>

  <div class="play-grid" [style.--play-grid-rows]="gamestate.field[0].length">
    <div class="grid-row" *ngFor="let row of gamestate.field; let index = index"
      [class.secret]="index === 0 || index === gamestate.field.length - 1">
      <div class="grid-space" *ngFor="let col of row; let current = index">
      </div>
    </div>
  </div>

  <div class="player-side" [class.current-turn]="gamestate.currentTurn === 0">

    <div class="deck" (click)="drawCard()">
      <div class="deck-card-container">
        <div class="deck-card" *ngFor="let deckSize of [0, 1, 2]" [style.--card-index]="deckSize">
          <sw-spell-card *ngIf="player.deck.length > deckSize" [spell]="contentService.getSpell('')!"
            [isUpsideDown]="true" [isSmall]="true"></sw-spell-card>
        </div>
      </div>
    </div>

    <div class="hand">
      <div class="hand-card-container">
        <div class="hand-card-position" *ngFor="let card of player.hand; let i = index" [style.--card-index]="i"
          (mouseenter)="focusHandCard(i)" (mouseleave)="unfocusHandCard()">
          <sw-spell-card class="hand-card" [spell]="contentService.getSpell(card.id)!"
            [isSmall]="hoveringSpellIndex !== i"></sw-spell-card>
        </div>
      </div>
    </div>

    <div class="stats">
      <div class="health player-health">
        <ngb-progressbar type="health" [value]="player.health" [max]="player.maxHealth" [animated]="true" height="24px">
          <strong>{{ player.health }} / {{ player.maxHealth }}</strong>
        </ngb-progressbar>
      </div>

      <div class="mana player-mana">
        @for(mana of manaArray(player.maxMana); track mana) {
        <div class="mana-orb" [class.active]="player.mana > mana"></div>
        }
      </div>
    </div>
  </div>
</div>